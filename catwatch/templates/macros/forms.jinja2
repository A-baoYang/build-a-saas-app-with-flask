{% macro with_errors(field) %}
  <div class="form-field">
    {% if field.errors %}
      {% set css_class = 'has-error ' + kwargs.pop('class', '') %}
      {{ field(class=css_class, **kwargs) }}
      <ul class="form-errors list--reset list-small">
        {% for error in field.errors %}
          <li>{{ error | e }}</li>
        {% endfor %}
      </ul>
    {% else %}
      {{ field(**kwargs) }}
    {% endif %}
  </div>
{% endmacro %}